(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{5003:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return T}});var t=l(2322),i=l(2784),d=l(753),r=l(8122),n=l(6992),s=l(6277),o=l(6622),c=l(3027),p=l(6812),m=l(5070),_=l(18),u=l(3658),v=l(2309),h=l(4699),f=l(3955);let x=e=>{let{methods:a,children:l,className:i,onSubmit:d=()=>{},onInvalid:r=()=>{}}=e;return(0,t.jsx)(f.RV,{...a,children:(0,t.jsx)("form",{onSubmit:a.handleSubmit(d,r),className:i,children:l})})};var j=l(8398),w=l.n(j);let M=e=>{let{targetCategoryId:a,targetIndex:l,setTargetIndex:d,onClose:r,editMode:n,uuid:j}=e,{push:M,pushUnderUuid:B,edit:E,templatesDataWithUuid:T}=(0,c.y)(),C=(0,i.useMemo)(()=>o._2[o.lq[a][l]],[a,l]),N=(0,i.useMemo)(()=>n&&j&&T[j].id===C.id?T[j].props:C.defaultValues,[T,n,j,C]),g=(0,i.useMemo)(()=>C.schema,[C]),b=(0,f.cI)({defaultValues:N,resolver:(0,p.X)(g)}),k=b.watch(),W=(0,i.useCallback)(()=>{0!==l&&d(e=>e-1)},[l,d]),Z=(0,i.useCallback)(()=>{l!==o.lq[a].length-1&&d(e=>e+1)},[a,l,d]);return(0,t.jsxs)(x,{methods:b,className:w().form,onSubmit:e=>{j?n?E({id:C.id,uuid:j,props:k}):B({id:C.id,uuid:j,props:e}):M({id:C.id,props:e}),r()},children:[(0,t.jsxs)("div",{className:w().previewWrapper,children:[(0,t.jsx)(m.hU,{type:"button",size:"large",onClick:W,className:(0,s.Z)(w().arrowBtn,w().leftBtn),disabled:0===l,children:(0,t.jsx)(_.Z,{icon:v.w})}),(0,t.jsx)("div",{className:w().preview,children:C.Template({...k})}),(0,t.jsx)(m.hU,{type:"button",size:"large",onClick:Z,className:(0,s.Z)(w().arrowBtn,w().rightBtn),disabled:l===o.lq[a].length-1,children:(0,t.jsx)(_.Z,{icon:h.X})})]}),(0,t.jsx)("div",{className:w().fieldsContainer,children:(0,t.jsx)("div",{className:w().fieldsWrapper,children:C.Editor()})}),(0,t.jsxs)("div",{className:w().modalFooter,children:[(0,t.jsx)(u.Z,{type:"button",variant:"contained",size:"large",onClick:r,children:"關閉"}),(0,t.jsx)(u.Z,{type:"submit",variant:"contained",size:"large",children:"確定"})]})]})};var B=(0,i.memo)(M);let E=e=>{var a;let{open:l,onClose:p,editMode:m,uuid:_}=e,{templatesDataWithUuid:u}=(0,c.y)(),[v,h]=(0,i.useState)(o.Y2[0].id),[f,x]=(0,i.useState)(0),j=(0,i.useMemo)(()=>null!==(a=o.Y2.find(e=>e.id===v))&&void 0!==a?a:null,[v]),M=(0,i.useMemo)(()=>o.lq[v],[v]),E=(0,i.useCallback)(e=>{h(e),x(0)},[]),T=(0,i.useMemo)(()=>m&&_?o._2[u[_].id]:null,[m,_,u]);return(0,i.useEffect)(()=>{if(T&&l){let e=T.category,a=o.lq[e].findIndex(e=>e===T.id);h(e),x(a)}},[T,l]),(0,i.useEffect)(()=>{l||(h(o.Y2[0].id),x(0))},[l]),(0,t.jsxs)(d.Z,{open:l,onClose:p,className:w().root,direction:"left",children:[(0,t.jsxs)("div",{className:w().modalHeader,children:[(0,t.jsx)("span",{className:w().modalTitle,children:"選擇模板"}),(0,t.jsx)(r.Z,{onChange:e=>{E(e.id)},value:j,children:null===o.Y2||void 0===o.Y2?void 0:o.Y2.map(e=>(0,t.jsx)(n.Z,{value:e.id,children:e.name},e.id))})]}),(0,t.jsx)("div",{className:w().previewBtnContainer,children:(0,t.jsx)("div",{className:w().previewBtnWrapper,children:M.map((e,a)=>{let l=o._2[e].Preview;return(0,t.jsx)("div",{className:(0,s.Z)(w().previewBtn,{[w().active]:a===f}),onClick:()=>{x(a)},children:(0,t.jsx)(l,{})},e)})})}),(0,t.jsx)(B,{targetCategoryId:v,targetIndex:f,setTargetIndex:x,onClose:p,uuid:_,editMode:m},"".concat(v,"-").concat(f,"-").concat(null!=_?_:"create"))]})};var T=E},8398:function(e){e.exports={root:"TemplateEditModal_root___R_8K",modalHeader:"TemplateEditModal_modalHeader__carOO",modalTitle:"TemplateEditModal_modalTitle__L3oBO",previewBtnContainer:"TemplateEditModal_previewBtnContainer__ijioB",previewBtnWrapper:"TemplateEditModal_previewBtnWrapper__Tz6uQ",previewBtn:"TemplateEditModal_previewBtn__ltEPs",active:"TemplateEditModal_active__dwqGn",form:"TemplateEditModal_form__MVDyd",previewWrapper:"TemplateEditModal_previewWrapper__UPsFt",preview:"TemplateEditModal_preview__FVUPr",arrowBtn:"TemplateEditModal_arrowBtn__og4Lb",leftBtn:"TemplateEditModal_leftBtn__NduzA",rightBtn:"TemplateEditModal_rightBtn__CDFO3",fieldsContainer:"TemplateEditModal_fieldsContainer__W2k4d",fieldsWrapper:"TemplateEditModal_fieldsWrapper__GBSA_",modalFooter:"TemplateEditModal_modalFooter__F_7rl"}}}]);