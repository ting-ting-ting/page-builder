(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{5003:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return E}});var t=l(2322),i=l(2784),d=l(823),r=l(856),n=l(6992),s=l(6277),o=l(2288),c=l(3027),p=l(5070),m=l(18),_=l(556),u=l(2309),v=l(4699),h=l(3955);let f=e=>{let{methods:a,children:l,className:i,onSubmit:d=()=>{},onInvalid:r=()=>{}}=e;return(0,t.jsx)(h.RV,{...a,children:(0,t.jsx)("form",{onSubmit:a.handleSubmit(d,r),className:i,children:l})})};var x=l(8398),j=l.n(x);let w=e=>{let{targetCategoryId:a,targetIndex:l,setTargetIndex:d,onClose:r,editMode:n,uuid:x}=e,{push:w,pushUnderUuid:M,edit:B,templatesDataWithUuid:E}=(0,c.y)(),T=(0,i.useMemo)(()=>o._2[o.lq[a][l]],[a,l]),C=(0,i.useMemo)(()=>n&&x&&E[x].id===T.id?E[x].props:T.defaultValues,[E,n,x,T]),N=(0,h.cI)({defaultValues:C}),g=N.watch(),b=(0,i.useCallback)(()=>{0!==l&&d(e=>e-1)},[l,d]),k=(0,i.useCallback)(()=>{l!==o.lq[a].length-1&&d(e=>e+1)},[a,l,d]);return(0,t.jsxs)(f,{methods:N,className:j().form,onSubmit:e=>{x?n?B({id:T.id,uuid:x,props:g}):M({id:T.id,uuid:x,props:e}):w({id:T.id,props:e}),r()},children:[(0,t.jsxs)("div",{className:j().previewWrapper,children:[(0,t.jsx)(p.hU,{type:"button",size:"large",onClick:b,className:(0,s.Z)(j().arrowBtn,j().leftBtn),disabled:0===l,children:(0,t.jsx)(m.Z,{icon:u.w})}),(0,t.jsx)("div",{className:j().preview,children:T.Template({...g})}),(0,t.jsx)(p.hU,{type:"button",size:"large",onClick:k,className:(0,s.Z)(j().arrowBtn,j().rightBtn),disabled:l===o.lq[a].length-1,children:(0,t.jsx)(m.Z,{icon:v.X})})]}),(0,t.jsx)("div",{className:j().fieldsContainer,children:(0,t.jsx)("div",{className:j().fieldsWrapper,children:T.Editor()})}),(0,t.jsxs)("div",{className:j().modalFooter,children:[(0,t.jsx)(_.Z,{type:"button",variant:"contained",size:"large",onClick:r,children:"關閉"}),(0,t.jsx)(_.Z,{type:"submit",variant:"contained",size:"large",children:"確定"})]})]})};var M=(0,i.memo)(w);let B=e=>{var a;let{open:l,onClose:p,editMode:m,uuid:_}=e,{templatesDataWithUuid:u}=(0,c.y)(),[v,h]=(0,i.useState)(o.Y2[0].id),[f,x]=(0,i.useState)(0),w=(0,i.useMemo)(()=>null!==(a=o.Y2.find(e=>e.id===v))&&void 0!==a?a:null,[v]),B=(0,i.useMemo)(()=>o.lq[v],[v]),E=(0,i.useCallback)(e=>{h(e),x(0)},[]),T=(0,i.useMemo)(()=>m&&_?o._2[u[_].id]:null,[m,_,u]);return(0,i.useEffect)(()=>{if(T&&l){let e=T.category,a=o.lq[e].findIndex(e=>e===T.id);h(e),x(a)}},[T,l]),(0,i.useEffect)(()=>{l||(h(o.Y2[0].id),x(0))},[l]),(0,t.jsxs)(d.Z,{open:l,onClose:p,className:j().root,direction:"left",children:[(0,t.jsxs)("div",{className:j().modalHeader,children:[(0,t.jsx)("span",{className:j().modalTitle,children:"選擇模板"}),(0,t.jsx)(r.Z,{onChange:e=>{E(e.id)},value:w,children:null===o.Y2||void 0===o.Y2?void 0:o.Y2.map(e=>(0,t.jsx)(n.Z,{value:e.id,children:e.name},e.id))})]}),(0,t.jsx)("div",{className:j().previewBtnContainer,children:(0,t.jsx)("div",{className:j().previewBtnWrapper,children:B.map((e,a)=>{let l=o._2[e].Preview;return(0,t.jsx)("div",{className:(0,s.Z)(j().previewBtn,{[j().active]:a===f}),onClick:()=>{x(a)},children:(0,t.jsx)(l,{})},e)})})}),(0,t.jsx)(M,{targetCategoryId:v,targetIndex:f,setTargetIndex:x,onClose:p,uuid:_,editMode:m},"".concat(v,"-").concat(f,"-").concat(null!=_?_:"create"))]})};var E=B},8398:function(e){e.exports={root:"TemplateEditModal_root___R_8K",modalHeader:"TemplateEditModal_modalHeader__carOO",modalTitle:"TemplateEditModal_modalTitle__L3oBO",previewBtnContainer:"TemplateEditModal_previewBtnContainer__ijioB",previewBtnWrapper:"TemplateEditModal_previewBtnWrapper__Tz6uQ",previewBtn:"TemplateEditModal_previewBtn__ltEPs",active:"TemplateEditModal_active__dwqGn",form:"TemplateEditModal_form__MVDyd",previewWrapper:"TemplateEditModal_previewWrapper__UPsFt",preview:"TemplateEditModal_preview__FVUPr",arrowBtn:"TemplateEditModal_arrowBtn__og4Lb",leftBtn:"TemplateEditModal_leftBtn__NduzA",rightBtn:"TemplateEditModal_rightBtn__CDFO3",fieldsContainer:"TemplateEditModal_fieldsContainer__W2k4d",fieldsWrapper:"TemplateEditModal_fieldsWrapper__GBSA_",modalFooter:"TemplateEditModal_modalFooter__F_7rl"}}}]);